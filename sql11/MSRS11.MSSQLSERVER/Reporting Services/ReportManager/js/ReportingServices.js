var checkBoxCount,checkBoxId,checkBoxHead,_divContextMenu,_selectedIdHiddenField,_timeOutLimit=3e3,_timeOutTimer,_itemSelected=false,_mouseOverContext=false,_contextMenusIds,_fadeTimeouts,_onLink=false,_selectedItemId,_tabFocusedItem="",_mouseOverItem="",_unselectedItemStyle,_currentContextMenuId,_currentMenuItemId=null,_searchTextBoxID,_defaultSearchValue;function ToggleItem(b){var a=document.getElementById(b);if(a.style.display=="none")a.style.display="inline";else a.style.display="none"}function ToggleButtonImage(c,d){var a=document.getElementById(c),b=document.getElementById(d);if(a.style.display=="none"){a.style.display="inline-block";b.style.display="none"}else{a.style.display="none";b.style.display="inline-block"}}function SetFocus(b){var a=document.getElementById(b);a!=null&&!a.disabled&&a.focus()}function ValidateDropDownSelection(c,a){var b=document.getElementById(c.controltovalidate);if(b.options[0].selected&&!b.disabled)a.IsValid=false;else a.IsValid=true}function selectAll(){for(var b,c=checkBoxHead.checked,a=0;a<checkBoxCount;a++){b=checkBoxId+a;document.getElementById(b).checked=c}}function onSglCheck(){checkBoxHead.checked=false}function ToggleButton(a,b){if(document.getElementById(a)!=null)document.getElementById(a).disabled=b}function ToggleValidator(b,a){document.getElementById(b).enabled=a}function SetCbVars(b,a,c){checkBoxCount=a;checkBoxId=b;checkBoxHead=c}function CheckCheckBoxes(f,e,d){var b,a,c;c=false;for(b=0;b<checkBoxCount;b++){a=f+b;if(document.getElementById(a).checked){a=e+a;if(document.getElementById(a)!=null){c=true;break}}}ToggleButton(d,c)}function HiddenCheckClickHandler(c,d){var a=document.getElementById(c),b=document.getElementById(d);b.checked=!a.checked}function validateSaveRole(e,b){for(var c,d=0,a=0;a<checkBoxCount;a++){c=checkBoxId+a;if(document.getElementById(c).checked)d++}if(0==d)b.IsValid=false;else b.IsValid=true}function PadIntWithZero(b){var a=b.toString();if(b<10&&b>=0)if(a.length==1)a="0"+a;else if(a.length>2)a=a.substring(a.length-2,a.length);return a}function PadInputInteger(a){document.getElementById(a).value=PadIntWithZero(document.getElementById(a).value)}var confirmSingle,confirmMultiple;function SetDeleteTxt(b,a){confirmSingle=b;confirmMultiple=a}function doCmDel(a){var b=confirmSingle;if(a==0)return false;if(a>1)b=confirmMultiple;return confirm(b)}function confirmDelete(){return doCmDel(getChkCount())}function confirmDeletePlcies(b){var a=getChkCount();if(a>=checkBoxCount){alert(b);return false}return doCmDel(a)}function getChkCount(){var a=0;for(i=0;i<checkBoxCount&&a<2;i++)if(document.getElementById(checkBoxId+i).checked)a++;return a}function ToggleButtonBasedOnCheckBox(d,a,b){var c=document.getElementById(d);if(c!=null)if(c.checked==true)ToggleButton(a,b);else ToggleButton(a,!b)}function ToggleButtonBasedOnCheckBoxWithOverride(c,a,b,d){if(b==true)ToggleButton(a,true);else ToggleButtonBasedOnCheckBox(c,a,d)}function ToggleButtonBasedOnCheckBoxes(d,c,a){var b=document.getElementById(d);if(b!=null)if(b.checked==true)ToggleButtonBasedOnCheckBox(c,a,false);else ToggleButton(a,true)}function ToggleButtonBasedOnCheckBoxesWithOverride(d,c,a,b){if(b==true)ToggleButton(a,true);else ToggleButtonBasedOnCheckBoxes(d,c,a)}function ToggleValidatorBasedOnCheckBoxWithOverride(d,a,c,e){if(c==true)ToggleValidator(a,false);else{var b=document.getElementById(d);b!=null&&ToggleValidator(a,b.checked!=e)}}function ToggleValidatorBasedOnCheckBoxesWithOverride(f,e,a,b,c){if(b==true)ToggleValidator(a,false);else{var d=document.getElementById(f);if(d!=null)if(d.checked==c)ToggleValidator(a,false);else ToggleValidatorBasedOnCheckBoxWithOverride(e,a,b,c)}}function CheckButton(b,a){document.getElementById(b).checked=a}function EnableMultiButtons(h){if(checkBoxCount==0||multiButtonList.length==0)return;var a=false,b=false,g=document.getElementById(h+"ch");if(g!=null&&g.checked){a=true;b=checkBoxCount>1}else for(var f=false,d=0;d<checkBoxCount;d++){var i=document.getElementById(h+"cb"+d);if(i.checked)if(f){b=true;break}else{a=true;f=true}}for(var e=0;e<multiButtonList.length;e++){var c=document.getElementById(multiButtonList[e]);if(c.allowMultiSelect)c.disabled=!a;else c.disabled=!a||b}}function MarkPasswordFieldChanged(a){if(event.propertyName=="value"){var d=document.getElementById("ui_txtStoredPwd"+a),c=document.getElementById("ui_shadowPasswordChanged"+a);if(d.IsInit){c.value="true";var b=document.getElementById("ui_validatorPassword"+a);b!=null&&ValidatorValidate(b)}}}function InitDataSourcePassword(a){var c=document.getElementById("ui_txtStoredPwd"+a),e=document.getElementById("ui_shadowPasswordChanged"+a),d=document.getElementById("ui_rdoStored"+a),b=document.getElementById("ui_validatorPassword"+a);c.IsInit=false;if(b!=null&&d.checked)c.value="********";else e.value="true";c.IsInit=true;b!=null&&ValidatorValidate(b)}function SetNeedPassword(a){var b=document.getElementById("ui_txtStoredPwd"+a);b.NeedPassword="true";ValidatorValidate(document.getElementById("ui_validatorPassword"+a))}function UpdateValidator(c,a){if(c.checked){var b=document.getElementById(a);ValidatorValidate(b)}}function ReEnterPasswordValidation(g,e){var c="ui_validatorPassword",a=g.id.substr(c.length,g.id.length-c.length),h=document.getElementById("ui_rdoStored"+a),f=document.getElementById("ui_txtStoredPwd"+a),i=document.getElementById("ui_shadowPasswordChanged"+a),b=document.getElementById("ui_rdoCustomDataSource"+a),d=true;if(b!=null)d=b.checked;if(!d||h.checked==false||f.UserEnteredPassword=="true"||f.NeedPassword!="true"||i.value=="true")e.IsValid=true;else e.IsValid=false}function ValidateDataSourceSelected(c,f){var b="ui_sharedDSSelectedValidator",d=c.id.substr(b.length,c.id.length-b.length),a=document.getElementById("ui_rdoSharedDataSource"+d),e=document.getElementById("ui_hiddenSharedDS"+d);f.IsValid=a!=null&&!a.checked||e.value!="NotSelected"}function MultiValueParamClass(i,d,b,c,g,e,h,a,f){this.m_thisID=i;this.m_visibleTextBoxID=d;this.m_floatingEditorID=b;this.m_floatingIFrameID=c;this.m_paramObject=g;this.m_hasValidValues=e;this.m_allowBlank=h;this.m_doPostbackOnHide=a;this.m_postbackScript=f;this.UpdateSummaryString()}function ToggleVisibility(){var a=GetControl(this.m_floatingEditorID);if(a.style.display!="inline")this.Show();else this.Hide()}MultiValueParamClass.prototype.ToggleVisibility=ToggleVisibility;function Show(){var a=GetControl(this.m_floatingEditorID);if(a.style.display=="inline")return;var d=GetControl(this.m_visibleTextBoxID);if(this.m_hasValidValues){if(a.offsetHeight>150)a.style.height=150;a.style.width=d.offsetWidth}var c=this.GetNewFloatingEditorPosition();a.style.left=c.Left;a.style.top=c.Top;a.style.display="inline";var b=GetControl(this.m_floatingIFrameID);b.style.left=a.style.left;b.style.top=a.style.top;b.style.width=a.offsetWidth;b.style.height=a.offsetHeight;b.style.display="inline";this.m_paramObject.ActiveMultValue!=this&&this.m_paramObject.ActiveMultiValue!=null&&ControlClicked(this.m_paramObject.id);this.m_paramObject.ActiveMultiValue=this;a.childNodes[0].focus&&a.childNodes[0].focus();this.StartPolling()}MultiValueParamClass.prototype.Show=Show;function Hide(){var a=GetControl(this.m_floatingEditorID),b=GetControl(this.m_floatingIFrameID);a.style.display="none";b.style.display="none";this.UpdateSummaryString();if(this.m_doPostbackOnHide)eval(this.m_postbackScript);if(this.m_paramObject.ActiveMultiValue==this)this.m_paramObject.ActiveMultiValue=null}MultiValueParamClass.prototype.Hide=Hide;function GetNewFloatingEditorPosition(){var b=GetControl(this.m_visibleTextBoxID),a=GetObjectPosition(b);return{Left:a.Left,Top:a.Top+b.offsetHeight}}MultiValueParamClass.prototype.GetNewFloatingEditorPosition=GetNewFloatingEditorPosition;function UpdateSummaryString(){var a;if(this.m_hasValidValues)a=GetValueStringFromValidValueList(this.m_floatingEditorID);else a=GetValueStringFromTextEditor(this.m_floatingEditorID,false,this.m_allowBlank);var b=GetControl(this.m_visibleTextBoxID);b.value=a}MultiValueParamClass.prototype.UpdateSummaryString=UpdateSummaryString;function StartPolling(){setTimeout(this.m_thisID+".PollingCallback();",100)}MultiValueParamClass.prototype.StartPolling=StartPolling;function PollingCallback(){var a=GetControl(this.m_floatingEditorID);if(a.style.display!="inline")return;var b=this.GetNewFloatingEditorPosition();if(a.style.left!=b.Left+"px"||a.style.top!=b.Top+"px")this.Hide();else this.StartPolling()}MultiValueParamClass.prototype.PollingCallback=PollingCallback;function GetObjectPosition(a){var c=0,b=0;while(a!=document.body){c+=a.offsetTop;b+=a.offsetLeft;a=a.offsetParent}c+=a.offsetTop;b+=a.offsetLeft;return{Left:b,Top:c}}function GetValueStringFromTextEditor(g,f,h){var j=GetControl(g),i=j.childNodes[0],c=i.value;if(!h){var d=c.split("\r\n"),e;if(f)e="\r\n";else e=", ";for(var a="",b=0;b<d.length;b++)if(d[b].length>0){if(a.length>0)a+=e;a+=d[b]}return a}else return f?c:c.replace(/\r\n/g,", ")}function GetValueStringFromValidValueList(i){var b="",f=GetControl(i),a=f.childNodes[0];if(a.nodeName!="TABLE")a=f.childNodes[1];var d=0;if(a.rows.length>1)d=1;for(var c=d;c<a.rows.length;c++){var g=a.rows[c].cells[0],e=g.childNodes[0],h=e.childNodes[0],j=e.childNodes[1];if(h.checked){if(b.length>0)b+=", ";b+=j.firstChild.nodeValue}}return b}function MultiValidValuesSelectAll(h,f){var c=GetControl(f),a=c.childNodes[0];if(a.nodeName!="TABLE")a=c.childNodes[1];for(var b=1;b<a.rows.length;b++){var d=a.rows[b].cells[0],g=d.childNodes[0],e=g.childNodes[0];e.checked=h.checked}}function ValidateMultiValidValue(c,d){var b=GetValueStringFromValidValueList(c),a=b.length>0;!a&&alert(d);return a}function ValidateMultiEditValue(c,d){var b=GetValueStringFromTextEditor(c,true,false),a=false;if(b.length>0)a=true;!a&&alert(d);return a}function GetControl(a){var b=document.getElementById(a);b==null&&alert("Unable to locate control: "+a);return b}function ControlClicked(b){var a=GetControl(b);a.ActiveMultiValue!=null&&a.ActiveMultiValue.Hide()}function InitContextMenu(c,a,d,e,b){ResetSearchBar(e,b);_divContextMenu=document.getElementById(c);_selectedIdHiddenField=document.getElementById(a);_contextMenusIds=d;_divContextMenu.onmouseover=function(){_mouseOverContext=true};_divContextMenu.onmouseout=function(){if(_mouseOverContext==true){_mouseOverContext=false;if(_timeOutTimer==null)_timeOutTimer=setTimeout(TimeOutAction,_timeOutLimit)}};document.body.onmousedown=ContextMouseDown;AddKeyDownListener()}function KeyDownHandler(a){if(_currentContextMenuId==null)return true;if(!a)a=window.event;var b=a.keyCode;return b==38||b==40?false:true}function AddKeyDownListener(){if(document.addEventListener)document.addEventListener("keydown",KeyDownHandler,false);else document.onkeydown=KeyDownHandler}function TimeOutAction(){_mouseOverContext==false&&UnSelectedMenuItem();_timeOutTimer=null}function Clicked(b,l){if(!_onLink){ClearTimeouts();SelectContextMenuFromColletion(l);_itemSelected=true;if(b==null)b=window.event;var i=b.target!=null?b.target:b.srcElement,a=GetOuterElementOfType(i,"table"),e=GetElementPosition(a);_selectedItemId=a.id;_selectedIdHiddenField.value=a.value;a.className="msrs-SelectedItem";ResetContextMenu();var g=_divContextMenu.offsetHeight,h=_divContextMenu.offsetWidth,o=a.offsetHeight,p=a.offsetWidth,j=e.left,k=e.top,d=0,c=0;if(typeof window.innerWidth=="number"){d=window.innerWidth;c=window.innerHeight}else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){d=document.documentElement.clientWidth;c=document.documentElement.clientHeight}else if(document.body&&(document.body.clientWidth||document.body.clientHeight)){d=document.body.clientWidth;c=document.body.clientHeight}var f=document.compatMode&&document.compatMode!="BackCompat"?document.documentElement:document.body,m=document.all?f.scrollLeft:pageXOffset,n=document.all?f.scrollTop:pageYOffset;_divContextMenu.style.left=SetContextMenuHorizonatalPosition(d,m,j,h,p)+"px";_divContextMenu.style.top=SetContextMenuVerticalPosition(c,n,k,g,o)+"px";ChangeOpacityForElement(100,_divContextMenu.id);document.getElementById(_currentContextMenuId).firstChild.focus()}}function OpenMenuKeyPress(b,c){if(b.altKey){var a;if(window.event)a=b.keyCode;else a=b.which;if(a==40){Clicked(event,c);HighlightContextMenuItem(true)}}}function NavigateMenuKeyPress(b){var a;if(window.event)a=b.keyCode;else a=b.which;if(a==40)HighlightContextMenuItem(true);else if(a==38)HighlightContextMenuItem(false);else if(a==27){UnSelectedMenuItem();document.getElementById(_selectedItemId).focus()}}function HighlightContextMenuItem(d){var e=document.getElementById(_currentContextMenuId),b=e.lastChild,c=-1;if(_currentMenuItemId!=null)c=document.getElementById(_currentMenuItemId).parentNode.rowIndex;var a=c;while(true){if(d){a++;if(a<0||a>=b.cells.length)a=0}else{a--;if(a<0||a>=b.cells.length)a=b.cells.length-1}if(b.cells[a].group>=0){FocusContextMenuItem(b.cells[a].id,"msrs-MenuUIItemTableHover","msrs-MenuUIItemTableCell");break}if(a==c)break}}function ResetContextMenu(){_divContextMenu.style.height="auto";_divContextMenu.style.width="auto";_divContextMenu.style.overflowY="visible";_divContextMenu.style.overflowX="visible";_divContextMenu.style.overflow="visible";_divContextMenu.style.display="block"}function SetContextMenuHorizonatalPosition(g,b,h,d,i){var a=h+i-d,e=g+b-a,f=a-b,c;if(d<e&&b<a)c=a;else if(d<e)c=b;else if(d<f)c=a-(d-(g+b-a));else{_divContextMenu.style.overflowX="scroll";if(f<e){_divContextMenu.style.width=e;c=b}else{_divContextMenu.style.width=f;c=a-(f-(g+b-a))}}return c}function SetContextMenuVerticalPosition(h,g,a,d,f){var e=h+g-(a+f),c=a-g,b;if(d<e)b=a+f;else if(d<c)b=a-d;else if(e>c){_divContextMenu.style.height=e;_divContextMenu.style.overflowY="scroll";b=a+f}else{_divContextMenu.style.height=c;_divContextMenu.style.overflowY="scroll";b=a-c}return b}function SelectContextMenuFromColletion(c){var b=SplitContextMenuConfigString(c);for(i=0;i<_contextMenusIds.length;i++){var a=document.getElementById(_contextMenusIds[i]);if(a.id==b){a.style.visibility="visible";a.style.display="block";_currentContextMenuId=b}else{a.style.visibility="hidden";a.style.display="none"}}}function SplitContextMenuConfigString(b){var c=b.indexOf(":"),j=b,g;if(c!=-1)j=b.substr(0,c);var l=document.getElementById(j),a=l.lastChild,d=[],h=[];for(i=0;i<a.cells.length;i++){a.cells[i].style.visibility="visible";a.cells[i].style.display="block";if(d.length-1<a.cells[i].group){d.push(1);h.push(a.cells[i].underline)}else d[a.cells[i].group]++;AlterVisibilityOfAssociatedUnderline(a.cells[i],true)}if(c!=-1){g=b.substr(c+1,b.length-1).split("-");var e=d;for(i=0;i<g.length;i++){var k=document.getElementById(g[i]);k.style.visibility="hidden";k.style.display="none";e[k.group]--}var f=true;for(i=e.length-1;i>-1;i--)if(e[i]==0)AlterVisibilityOfAssociatedUnderline(h[i],false);else if(f&&i==e.length-1)f=false;else if(f){f=false;AlterVisibilityOfAssociatedUnderline(h[i],false)}}return j}function AlterVisibilityOfAssociatedUnderline(b,c){if(b!=null&&b!=""){var a=document.getElementById(b);if(a!=null)if(c){a.style.visibility="visible";a.style.display="block"}else{a.style.visibility="hidden";a.style.display="none"}}}function ClearTimeouts(){if(_fadeTimeouts!=null)for(i=0;i<_fadeTimeouts.length;i++)clearTimeout(_fadeTimeouts[i]);_fadeTimeouts=[]}function FadeOutElement(f,b,d,c){ClearTimeouts();var e=Math.round(c/100),a=0;for(i=b;i>=d;i--){_fadeTimeouts.push(setTimeout("ChangeOpacityForElement("+i+",'"+f+"')",a*e));a++}}function ChangeOpacityForElement(a,c){var b=document.getElementById(c).style;if(a!=0){b.opacity=a/100;b.MozOpacity=a/100;b.KhtmlOpacity=a/100;b.filter="alpha(opacity="+a+")"}else b.display="none"}function ContextMouseDown(){if(_mouseOverContext)return;else HideMenu()}function UnSelectedMenuItem(){if(_itemSelected){FadeOutElement(_divContextMenu.id,100,0,300);UnselectCurrentMenuItem()}}function HideMenu(){if(_itemSelected){ChangeOpacityForElement(0,_divContextMenu.id);UnselectCurrentMenuItem()}}function UnselectCurrentMenuItem(){_itemSelected=false;_currentContextMenuId=null;SwapStyle(_currentMenuItemId,"msrs-MenuUIItemTableCell");_currentMenuItemId=null;ChangeReportItemStyle(_selectedItemId,"msrs-UnSelectedItem")}function GetOuterElementOfType(a,b){while(a.tagName.toLowerCase()!=b)a=a.parentNode;return a}function GetElementPosition(a){a=GetOuterElementOfType(a,"table");var b,c;b=c=0;if(a.offsetParent)do{b+=a.offsetLeft;c+=a.offsetTop}while(a=a.offsetParent);return{left:b,top:c}}function FocusContextMenuItem(a,b,c){SwapStyle(_currentMenuItemId,c);SwapStyle(a,b);document.getElementById(a).firstChild.focus();_currentMenuItemId=a}function SwapStyle(c,b){if(document.getElementById){var a=document.getElementById(c);if(a!=null)a.className=b}}function ChangeReportItemStyle(e,b){if(!_itemSelected)if(document.getElementById){var a=document.getElementById(e);a.className=b;if(a.tagName.toLowerCase()=="table"){var c=a.lastChild;if(c!=null){var d=c.lastChild;if(d!=null)d.lastChild.className=b+"End"}}}}function ChangeReportItemStyleOnFocus(a,c,b){_unselectedItemStyle=b;_tabFocusedItem=a;if(_mouseOverItem!=""){ChangeReportItemStyle(_mouseOverItem,_unselectedItemStyle);_mouseOverItem=""}ChangeReportItemStyle(a,c)}function ChangeReportItemStyleOnBlur(b,a){ChangeReportItemStyle(b,a);_tabFocusedItem=""}function ChangeReportItemStyleOnMouseOver(a,c,b){_unselectedItemStyle=b;_mouseOverItem=a;if(_tabFocusedItem!=""){ChangeReportItemStyle(_tabFocusedItem,_unselectedItemStyle);_tabFocusedItem=""}ChangeReportItemStyle(a,c)}function ChangeReportItemStyleOnMouseOut(b,a){ChangeReportItemStyle(b,a);_mouseOverItem=""}function SearchBarClicked(d,b,c){var a=document.getElementById(d);if(a.value==b){a.value="";a.className=c}}function SearchBarBlured(d,b,c){var a=document.getElementById(d);if(a.value==""){a.value=b;a.className=c}}function ResetSearchBar(c,b){var a=document.getElementById(c);if(a!=null)if(a.value==b)a.className="msrs-searchDefaultFont";else a.className="msrs-searchBarNoBorder"}function OnLink(){_onLink=true}function OffLink(){_onLink=false}function ShouldDelete(a){if(_selectedIdHiddenField.value!=null||_selectedIdHiddenField.value!=""){var b=a.replace("{0}",_selectedIdHiddenField.value),c=confirm(b);return c==true?true:false}else return false}function UpdateValidationButtonState(e,g,d,f){var a=document.getElementById(g);if(a==null)return;var h=a.options[a.selectedIndex].value,c=d.split(":"),b=false;for(i=0;i<c.length;i++)if(c[i]==h)b=true;var j=b||IsRadioButtonChecked(e);ChangeDisabledButtonState(f,j)}function ChangeDisabledButtonState(c,b){var a=document.getElementById(c);if(a!=null)a.disabled=b}function IsRadioButtonChecked(b){var a=document.getElementById(b);return a!=null&&a.checked?true:false};